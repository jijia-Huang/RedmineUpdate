# 如何開啟專案

本文件說明如何啟動 Redmine 進度回報自動化工具。

## 📋 前置需求

在開始之前，請確認已安裝以下工具：

- ✅ **Python 3.9+**
- ✅ **Conda**（用於管理 `GPTAction` 環境）
- ✅ **Git**
- ✅ **Claude Code CLI** 或 **Gemini CLI**（已安裝並登入）

## 🚀 快速開始

### 步驟 1：啟動 Conda 環境

開啟終端機（PowerShell 或 CMD），執行：

```bash
conda activate GPTAction
```

### 步驟 2：確認工作目錄

確認你在專案根目錄：

```bash
cd D:\Tool\RedmineUpdate
```

### 步驟 3：安裝依賴套件（首次使用）

如果是第一次使用，需要安裝 Python 套件：

```bash
pip install -r requirements.txt
```

### 步驟 4：設定配置檔

確認 `config.json` 已存在且設定正確。如果沒有，可以複製範例檔：

```bash
copy config.example.json config.json
```

然後編輯 `config.json`，設定：
- Redmine URL 和 API Key
- Git 使用者資訊（或啟用自動偵測）
- AI 提供者設定（Claude 或 Gemini）

### 步驟 5：啟動應用程式

使用以下命令啟動：

```bash
uvicorn app:app --host 0.0.0.0 --port 8000 --reload
```

或使用 Python 直接執行：

```bash
python app.py
```

### 步驟 6：開啟瀏覽器

**重要**：不要使用 `http://0.0.0.0:8000`，請使用以下任一網址：

- 🌐 **http://localhost:8000**（推薦）
- 🌐 **http://127.0.0.1:8000**

## ✅ 確認啟動成功

當你看到以下訊息時，表示伺服器已成功啟動：

```
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     Started server process [xxxxx]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
```

然後在瀏覽器中訪問 `http://localhost:8000`，應該會看到 Redmine 進度回報工具的介面。

## 🔧 常見問題排除

### 問題 1：無法訪問 http://localhost:8000

**可能原因：**
- 使用了 `http://0.0.0.0:8000`（瀏覽器無法訪問）
- 防火牆阻擋
- 端口被占用

**解決方法：**
1. 確認使用 `http://localhost:8000` 或 `http://127.0.0.1:8000`
2. 檢查防火牆設定，允許 8000 端口
3. 如果端口被占用，可以改用其他端口：
   ```bash
   uvicorn app:app --host 0.0.0.0 --port 8080 --reload
   ```
   然後訪問 `http://localhost:8080`

### 問題 2：找不到 config.json

**解決方法：**
```bash
copy config.example.json config.json
```
然後編輯 `config.json` 填入你的設定。

### 問題 3：模組找不到（ModuleNotFoundError）

**解決方法：**
確認已啟動 Conda 環境並安裝依賴：
```bash
conda activate GPTAction
pip install -r requirements.txt
```

### 問題 4：Redmine 連線失敗

**解決方法：**
1. 檢查 `config.json` 中的 Redmine URL 是否正確
2. 確認 API Key 是否有效
3. 檢查網路連線

### 問題 5：Git 儲存庫找不到

**解決方法：**
1. 確認 Git 使用者設定：
   ```bash
   git config --global user.name "你的名稱"
   git config --global user.email "your.email@example.com"
   ```
2. 或在 `config.json` 中設定 Git 使用者資訊
3. 在設定頁面手動新增儲存庫路徑

### 問題 6：Claude/Gemini CLI 執行失敗

**解決方法：**
1. 確認 CLI 已安裝：
   ```bash
   claude --version
   # 或
   gemini --version
   ```
2. 確認已登入：
   ```bash
   claude auth status
   # 或
   gemini auth status
   ```
3. 檢查 `config.json` 中的 CLI 路徑設定

## 📝 完整啟動流程範例

```bash
# 1. 啟動 Conda 環境
conda activate GPTAction

# 2. 進入專案目錄
cd D:\Tool\RedmineUpdate

# 3. （首次使用）安裝依賴
pip install -r requirements.txt

# 4. （首次使用）設定配置檔
# 編輯 config.json，填入 Redmine 和 Git 設定

# 5. 啟動應用程式
uvicorn app:app --host 0.0.0.0 --port 8000 --reload

# 6. 開啟瀏覽器，訪問 http://localhost:8000
```

## 🛑 停止應用程式

在終端機中按 `Ctrl + C` 即可停止伺服器。

## 📚 更多資訊

- 詳細功能說明請參考 [README.md](README.md)
- 專案規格請參考 [SPEC.md](SPEC.md)
- 開發筆記請參考 [IMPLEMENTATION_NOTES.md](IMPLEMENTATION_NOTES.md)

## 💡 提示

- 使用 `--reload` 參數可以在修改程式碼後自動重新載入（開發模式）
- 生產環境建議移除 `--reload` 參數
- 如果遇到問題，檢查終端機的錯誤訊息，通常會提供有用的資訊
